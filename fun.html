<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.i">
    <title>Create your own Recipes</title>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=PT+Sans+Narrow&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">
    <link rel="stylesheet" href="fun.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

</head>

<body>
    <nav>
        <div class="nav-wrapper indigo">
            <div class="container ">
                <a class="brand-logo">Boteco Virtual</a>
                <ul id="nav-mobile" class="right hide-on-med-and-down">
                    <li><a href="index.html">Home</a></li>
                    <li><a href="fun.html">Recipes</a></li>
                    <li><a href="collapsible.html">Cocktails</a></li>
                </ul>   
            </div>
        </div>
      </nav>
        <div>
            <div class="row" id="cuisine-type">
                <div class="col s1">                    
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col s6">
                <div class="container recipe-input">
                <div class="row">               
                <div class="input-field col s6">
                    <input id="cuisineInput" class="input-display" placeholder="Search Recipe" type="text" >
                    <label class="input-display"><h5>Looking for a specific recipe?</h5></label>
                 </div>                
                </div> 
                <div class="row">
                    <h6>Favorite Recipes :</h6>
                </div> 
                <div class="row" id="favoriteRecipes"></div>              
            </div>
        </div>   

            <div class="col s6">
                <div class="container recipe-display"> 
                    <div class="carousel container right">
                        
                    </div>
                </div>
            </div>
        </div>        
        </div>
    </div>
    </div>

    <script>

        $(document).ready(function () {

            $(document).ready(function () {
                $('.carousel').carousel();
        
            });
            $(document).ready(function(){
                $('.tabs').tabs();
            });

            var images = ["https://images.pexels.com/photos/1633578/pexels-photo-1633578.jpeg?auto=compress&cs=tinysrgb&dpr=1&w=500",
            "https://encrypted-tbn0.gstatic.com/images?q=tbn%3AANd9GcRInSQ1nPRiuGI8RM9KBKktKQiYWZDAo2h6337alkcUC2jl8ljB",
            "https://encrypted-tbn0.gstatic.com/images?q=tbn%3AANd9GcTfVOpPNbaY--0EMzBjhVma5VzBjPaqjeWhHn1uo_YHr96gpsiX",
            "https://encrypted-tbn0.gstatic.com/images?q=tbn%3AANd9GcRRajM0BreC2G8SQP73NCLKpkJdH4MlJUwD5FRFkeWHh9wg9eIv",
            "https://encrypted-tbn0.gstatic.com/images?q=tbn%3AANd9GcSzpZewtNMAncAPqX6ybw9WqQ9S9il2PGXio4bI8LmKnZJi2FTc",
            "https://encrypted-tbn0.gstatic.com/images?q=tbn%3AANd9GcQT302oOUQHfApUHnL_t6qFriZ0817JxikRzvY2KqT5f6ozid18",
            "https://www.sheknows.com/wp-content/uploads/2018/08/ti8wzfbbvdspxo8dg1ci.jpeg",
            "https://encrypted-tbn0.gstatic.com/images?q=tbn%3AANd9GcRRLzcnZXcCOp06zZ8giV0FmIge2_T4iai_ySPlgGxnAQ6yjSdX", 
            "https://encrypted-tbn0.gstatic.com/images?q=tbn%3AANd9GcSPGlJvv0HhZgKbiB9G4T6f--Wkwkuk4Ncz9hXGt7d258K8PGc6"];

            var names = ["American", "Asian", "South American", "Japanese", "Vegetarian", "Chinese", "Indian", "Mediterranean", "British" ];
            var apiKey = "3ecacdc43749b0d1697331f53d557613";
            var appId = "b81fa997";
            var cuisine = $("#cuisineInput").val();
            var recipe = $("#recipeInput").val();
            

            var recipes = [];
                        

            for (var i = 0; i < images.length; i++){
            
            
            var links = $(`            
            <div class="col s1">
                    <div class="row">
                        <a class="cuisine-links" data-name = "${names[i]}" href = "#"><img id ="navLinks${i}" src="${images[i]}" width="40px" height="40px"></a>
                    </div>
                    <div class="row">
                        <span class="cuisine-type">${names[i]}</span>
                    </div>
                </div>            
            `);
            $("#cuisine-type").append(links);
            };
           
            $(document).on("click", ".cuisine-links", function(){
            
            cuisine = $(this).attr("data-name");

            searchCuisine(cuisine);          
            
            });
            $(document).on("click", ".addFavorite", function(){
                console.log("clicked")
            })

            $("#cuisineInput").on("keydown", function(event){
                
                var keypressed = event.keyCode || event.which;
                var cuisine = $("#cuisineInput").val();
                    if (keypressed == 13) {   

                        searchCuisine(cuisine);                                          
                    } 
                $(".carousel").empty();               
            });

           

            function searchCuisine(cuisine){
                
                queryURL = `https://api.edamam.com/search?q=${cuisine}&app_id=${appId}&app_key=${apiKey}&from=0&to=30`;

                getRecipes(cuisine);
                $(".carousel").empty();
            };

            
            function appendRecipes(recipes) {
                
                for (var i = 0; i < recipes.length; i++){

                    var calories = Math.floor(recipes[i].info.calories / recipes[i].info.yield);                   

                            var displayRecipes = $(`
                            <div class="carousel-item">
                                <h5 id="recipeTitle">${recipes[i].info.label}</h5>
                                <a href ='${recipes[i].info.url}'><img src =${recipes[i].info.image} width = "300px" height = "300px"></a> 
                                <p class="recipeInfo"><strong>Calories per serving : ${calories}</strong></p>
                                <p class="recipeInfo"><strong>Servings : ${recipes[i].info.yield}</strong></p>
                                <a class="waves-effect waves-light btn addFavorite"><i class="material-icons right">add</i><strong>Add to Favorites</strong></a>
                                </div>
                            `)
                            $('.carousel').append(displayRecipes); 
                            displayRecipes.attr("id", "carouselItem"+[i]);
                            $("#carouselItem"+[i]).css({width: "500px", height: "550px"});
                           

                            $('.carousel').carousel();             
                    
                }

            }
        
            function getRecipes(cuisine) {

                var queryURL = `https://api.edamam.com/search?q=${cuisine}&app_id=${appId}&app_key=${apiKey}&from=0&to=30`;

                $.ajax({

                    url: queryURL,
                    method: "GET"

                }).then(function (response) {
                 
                    console.log(queryURL)
                    var result = [];
                    for (var i = 0; i < response.hits.length; i++) {
                        var tempObj = { type: response.q, info: response.hits[i].recipe };
                        result.push(tempObj);
                    }
                    
                    recipes = result;
                    appendRecipes(result);
                })

            }                    
        })

    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
    


</body>

</html>
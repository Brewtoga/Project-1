<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.i">
    <title>Create your own Recipes</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">
    <link rel="stylesheet" href="fun.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

</head>

<body>
    <nav>
        <div class="nav-wrapper indigo">
            <div class="container ">
                <a class="brand-logo">Boteco Virtual</a>
                <ul id="nav-mobile" class="right hide-on-med-and-down">
                    <li><a href="index.html">Home</a></li>
                    <li><a href="fun.html">Recipes</a></li>
                    <li><a href="collapsible.html">Cocktails</a></li>
                </ul>   
            </div>
        </div>
      </nav>
        <div>
            <div class="row" id="cuisine-type">
                <div class="col s1">                    
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col s6">
                <div class="container recipe-input">
                <div class="row">
                <div class="input-field col s6">
                    <input id="cuisineInput" class="input-display" placeholder="Cuisine" type="text" >
                    <label class="input-display">Type of Cuisine (Optional)</label>
                </div>
                </div>
                <div class="row">
                <div class="input-field col s6">
                    <input id="recipeInput"  class="input-display" placeholder="Favorite Recipe"  type="text">
                    <label class="input-display">Type a Recipe (Optional)</label>
                </div>
                </div>
            </div>
        </div>   

            <div class="col s6">
                <div class="container recipe-display"> 
                    <div class="carousel container right">
                        <!-- <div class="carousel-item z-depth-5" id='one'></div>
                        <div class="carousel-item z-depth-5" id='two'></div>
                        <div class="carousel-item z-depth-5" id='three'></div>
                        <div class="carousel-item z-depth-5" id='four'></div>
                        <div class="carousel-item z-depth-5" id='five'></div>
                        <div class="carousel-item z-depth-5" id='six'></div>
                        <div class="carousel-item z-depth-5" id='seven'></div>
                        <div class="carousel-item z-depth-5" id='eight'></div>
                        <div class="carousel-item z-depth-5" id='nine'></div>
                        <div class="carousel-item z-depth-5" id='ten'></div> -->
                    </div>
                </div>
            </div>
        </div>        
        </div>
    </div>
    </div>

    <script>

        $(document).ready(function () {

            var images = ["https://images.pexels.com/photos/1633578/pexels-photo-1633578.jpeg?auto=compress&cs=tinysrgb&dpr=1&w=500",
            "https://encrypted-tbn0.gstatic.com/images?q=tbn%3AANd9GcRInSQ1nPRiuGI8RM9KBKktKQiYWZDAo2h6337alkcUC2jl8ljB",
            "https://encrypted-tbn0.gstatic.com/images?q=tbn%3AANd9GcTfVOpPNbaY--0EMzBjhVma5VzBjPaqjeWhHn1uo_YHr96gpsiX",
            "https://encrypted-tbn0.gstatic.com/images?q=tbn%3AANd9GcRRajM0BreC2G8SQP73NCLKpkJdH4MlJUwD5FRFkeWHh9wg9eIv",
            "https://encrypted-tbn0.gstatic.com/images?q=tbn%3AANd9GcSzpZewtNMAncAPqX6ybw9WqQ9S9il2PGXio4bI8LmKnZJi2FTc",
            "https://encrypted-tbn0.gstatic.com/images?q=tbn%3AANd9GcQT302oOUQHfApUHnL_t6qFriZ0817JxikRzvY2KqT5f6ozid18",
            "https://www.sheknows.com/wp-content/uploads/2018/08/ti8wzfbbvdspxo8dg1ci.jpeg",
            "https://encrypted-tbn0.gstatic.com/images?q=tbn%3AANd9GcRRLzcnZXcCOp06zZ8giV0FmIge2_T4iai_ySPlgGxnAQ6yjSdX", 
            "https://encrypted-tbn0.gstatic.com/images?q=tbn%3AANd9GcSPGlJvv0HhZgKbiB9G4T6f--Wkwkuk4Ncz9hXGt7d258K8PGc6"];

            var names = ["American", "Asian", "South American", "Japanese", "Vegetarian", "Chinese", "Indian", "Mediterranean", "British" ];
            var apiKey = "3ecacdc43749b0d1697331f53d557613";
            var appId = "b81fa997";
            var cuisine = $("#cuisineInput").val();
            var recipe = $("#recipeInput").val();
            

            var recipes = [];
            var display = ["one", "two", "three", "four", "five", "six", "seven", "eight", "nine", "ten"];

            $(document).ready(function () {
                $('.carousel').carousel();
        
            });
            $(document).ready(function(){
                $('.tabs').tabs();
            });

            for (var i = 0; i < images.length; i++){
            
            var links = $(`            
            <div class="col s1">
                    <div class="row">
                        <a class="cuisine-links" data-name = "${names[i]}" href = "#"><img src="${images[i]}" width="40px" height="40px"></a>
                    </div>
                    <div class="row">
                        <span class="cuisine-type">${names[i]}</span>
                    </div>
                </div>            
            `)
                       
           $("#cuisine-type").append(links);
       
        }
        $(document).on("click", ".cuisine-links", function(){
            
            cuisine = $(this).attr("data-name");
            searchCuisine(cuisine);

        });

            $("#cuisineInput").on("keydown", function(event){
                
                var keypressed = event.keyCode || event.which;
                var cuisine = $("#cuisineInput").val();
                if (keypressed == 13) {                    
                    searchCuisine(cuisine);
                    // $(".recipe-display").removeClass("hide");
                }                
            });

            $("#recipeInput").on("keydown", function(event){
                var keypressed = event.keyCode || event.which;
                var recipe = $("#recipeInput").val();
                if (keypressed == 13) {                    
                    searchRecipe(recipe);
                }
            });

            function searchCuisine(cuisine){
                
                queryURL = `https://api.edamam.com/search?q=${cuisine}&app_id=${appId}&app_key=${apiKey}&from=0&to=30`;

                getRecipes();

            };

            function searchRecipe(recipe){

               
                queryURL = `https://api.edamam.com/search?q=${recipe}&app_id=${appId}&app_key=${apiKey}&from=0&to=30`;

                getRecipes();

            };
                        
            function appendRecipes(recipes) {
                
                for (var i = 0; i < recipes.length; i++){

                    var calories = Math.floor(recipes[i].info.calories / recipes[i].info.yield);

                   

                            var displayRecipes = $(`
                            <div class="carousel-item">
                                <h5 id="recipeTitle">${recipes[i].info.label}</h5>
                                <a href ='${recipes[i].info.url}'><img src =${recipes[i].info.image} width = "300px" height = "300px"></a> 
                                <p>Calories per serving : ${calories}</p>
                                <p>Servings : ${recipes[i].info.yield}</p>                 
                                </div>
                            `)
                            $('.carousel').append(displayRecipes); 
                            displayRecipes.attr("id", "carouselItem"+[i]);
                            $("#carouselItem"+[i]).css({width: "500px", height: "600px" });
                            $("#carouselItem"+[i]).addClass("carousel-item ");

                            $('.carousel').carousel();             
                    
                }

                }
        
            function getRecipes(cuisine) {
                var queryURL = `https://api.edamam.com/search?q=${cuisine}&app_id=${appId}&app_key=${apiKey}&from=0&to=30`;
                $.ajax({

                    url: queryURL,
                    method: "GET"

                }).then(function (response) {
                 
                    
                    var result = [];
                    for (var i = 0; i < response.hits.length; i++) {
                        var tempObj = { type: response.q, info: response.hits[i].recipe };
                        result.push(tempObj);
                    }
                    console.log('inThen: ', result);
                    recipes = result;
                    appendRecipes(result);
                })

            }                     
        })

    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.4.1.slim.min.js"
        integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPoiiEjwBvKU7imGFAViwwj1yYfoRSJoZ+n"
        crossorigin="anonymous"></script>


</body>

</html>